# Maintainer: Ash Logan <ash [at] heyquark [dot] com>

pkgname=ppc-libvorbis
pkgver=1.3.6
pkgrel=1
pkgdesc="A MOD playing library"
url="https://www.xiph.org"
license=("custom")
arch=("any")
depends=("devkitPPC" "ppc-libogg")
makedepends=("wiiu-pkg-config")
groups=("wiiu-libs")
source=("http://downloads.xiph.org/releases/vorbis/libvorbis-$pkgver.tar.xz")
sha256sums=("af00bb5a784e7c9e69f56823de4637c350643deedaf333d0fa86ecdba6fcb415")
options=("!buildflags" "!strip" "staticlibs")

_prefix="/opt/devkitpro/portlibs/ppc"

build() {
    export PATH=/opt/devkitpro/tools/bin:/opt/devkitpro/devkitPPC/bin:$PATH
    export PATH=/opt/devkitpro/portlibs/ppc/bin:$PATH
    export PATH=$_prefix/bin:$PATH
    export PKG_CONFIG=/opt/devkitpro/portlibs/wiiu/bin/powerpc-eabi-pkg-config

    cd libvorbis-${pkgver}
    ./configure \
        --prefix=$_prefix \
        --host=powerpc-eabi \
        --disable-shared \
        --disable-dependency-tracking \
        --disable-oggtest
    make
}

package() {
    cd libvorbis-${pkgver}
    make install DESTDIR=$pkgdir
}
